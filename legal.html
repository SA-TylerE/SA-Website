<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Legal | System Alternatives</title>
  <meta name="description" content="Legal terms, agreements, and data processing addenda for System Alternatives services." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/base.css" />
  <link rel="stylesheet" href="/assets/css/legal.css" />
  <script src="/assets/js/includes.js" defer></script>
</head>
<body>

  <!-- Shared header -->
  <div data-include="/partials/header.html"></div>

  <main class="legal-page">
    <!-- Hero -->
    <section class="hero hero--light legal-hero">
      <div class="container">
        <div class="hero__inner">
          <h1>Legal & Agreements</h1>
          <p class="lead">Select a document to preview or open in a new tab. The preview will appear below once selected.</p>
          <p class="legal-note">If a site blocks embedding, clicking a button will open the document directly.</p>
        </div>
      </div>
    </section>

    <!-- Buttons row (now on top) -->
    <section class="section">
      <div class="container">
        <div class="doc-list" role="list">
          <a class="btn btn--doc doc-btn" role="listitem"
             href="https://mspterms.live/system-alternatives/MSA"
             data-doc-title="Master Services Agreement"
             data-doc-url="https://mspterms.live/system-alternatives/MSA">
             Master Services Agreement
          </a>

          <a class="btn btn--doc doc-btn" role="listitem"
             href="https://mspterms.live/system-alternatives/Managed-Services-Omnibus"
             data-doc-title="Managed Services"
             data-doc-url="https://mspterms.live/system-alternatives/Managed-Services-Omnibus">
             Managed Services
          </a>

          <a class="btn btn--doc doc-btn" role="listitem"
             href="https://mspterms.live/system-alternatives/DPA"
             data-doc-title="Data Processing"
             data-doc-url="https://mspterms.live/system-alternatives/DPA">
             Data Processing
          </a>

          <a class="btn btn--doc doc-btn" role="listitem"
             href="https://mspterms.live/system-alternatives/Co-Managed-Services"
             data-doc-title="Co-Managed Services"
             data-doc-url="https://mspterms.live/system-alternatives/Co-Managed-Services">
             Co-Managed Services
          </a>

          <a class="btn btn--doc doc-btn" role="listitem"
             href="https://mspterms.live/system-alternatives/Third-Party-Services"
             data-doc-title="Third-Party Services"
             data-doc-url="https://mspterms.live/system-alternatives/Third-Party-Services">
             Third-Party Services
          </a>
        </div>
      </div>
    </section>

    <!-- Full-width preview (hidden until used) -->
    <section class="section" id="previewSection" hidden>
      <div class="container">
        <aside class="legal-preview" aria-live="polite">
          <header class="legal-preview__bar">
            <div class="legal-preview__titles">
              <strong id="previewTitle">Select a document to preview</strong>
              <span id="previewUrl" class="legal-preview__url"></span>
            </div>
            <div class="legal-preview__actions">
              <a id="previewOpenBtn" class="btn btn--ghost" href="#" target="_blank" rel="noopener" aria-disabled="true">Open in new tab</a>
            </div>
          </header>

          <div class="legal-preview__framewrap">
            <div id="previewFallback" class="legal-preview__fallback">
              <p>Nothing loaded yet. Choose a document above to start a preview.</p>
            </div>
            <iframe id="previewFrame" class="legal-preview__frame" title="Document preview"
                    sandbox="allow-same-origin allow-forms allow-scripts allow-popups"
                    loading="lazy" referrerpolicy="no-referrer"></iframe>
            <div id="previewSpinner" class="legal-preview__spinner" aria-hidden="true"></div>
          </div>

          <div id="previewBlocked" class="legal-preview__blocked" hidden>
            <p><strong>Preview blocked by the publisher.</strong> Opening the document directlyâ€¦</p>
          </div>
        </aside>
      </div>
    </section>

    <!-- Small print -->
    <section class="section">
      <div class="container">
        <p class="legal-smallprint">
          Tip: If you were directed here from a quote or order form, the version of the terms that applies is the one referenced in that document (or the most recent version published before your acceptance).
        </p>
      </div>
    </section>
  </main>

  <!-- Shared footer -->
  <div data-include="/partials/footer.html"></div>

  <script>
    (function () {
      // Reveal-on-scroll (unchanged)
      const allSections = Array.from(document.querySelectorAll('section'));
      const sectionsToReveal = allSections.slice(1);
      sectionsToReveal.forEach(sec => sec.classList.add('reveal'));
      const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (!reduceMotion) {
        const io = new IntersectionObserver((entries, obs) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              obs.unobserve(entry.target);
            }
          });
        }, { threshold: 0.15 });
        sectionsToReveal.forEach(sec => io.observe(sec));
      } else {
        sectionsToReveal.forEach(sec => sec.classList.add('is-visible'));
      }

      // Preview logic
      const buttons = document.querySelectorAll('.doc-btn');
      const previewSection = document.getElementById('previewSection');
      const frame = document.getElementById('previewFrame');
      const spinner = document.getElementById('previewSpinner');
      const fallback = document.getElementById('previewFallback');
      const blocked = document.getElementById('previewBlocked');
      const titleEl = document.getElementById('previewTitle');
      const urlEl = document.getElementById('previewUrl');
      const openBtn = document.getElementById('previewOpenBtn');

      let loadingTimer;

      function showPreviewSection() {
        if (previewSection.hasAttribute('hidden')) {
          previewSection.removeAttribute('hidden');
          // smooth scroll into view for good UX
          previewSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      function loadDoc(title, url, opts = { autoNavigateOnBlock: false }) {
        showPreviewSection();
        blocked.hidden = true;
        fallback.style.display = 'none';
        spinner.style.display = 'grid';
        spinner.setAttribute('aria-hidden', 'false');

        titleEl.textContent = title || 'Document';
        urlEl.textContent = url || '';
        openBtn.href = url || '#';
        if (url) openBtn.removeAttribute('aria-disabled'); else openBtn.setAttribute('aria-disabled','true');

        // reset + load
        frame.src = 'about:blank';
        requestAnimationFrame(() => { frame.src = url; });

        clearTimeout(loadingTimer);
        loadingTimer = setTimeout(() => {
          // likely blocked by XFO/CSP
          spinner.style.display = 'none';
          spinner.setAttribute('aria-hidden', 'true');
          blocked.hidden = false;

          if (opts.autoNavigateOnBlock && url) {
            try { window.location.assign(url); } catch (e) {}
          }
        }, 3500);
      }

      frame.addEventListener('load', () => {
        clearTimeout(loadingTimer);
        spinner.style.display = 'none';
        spinner.setAttribute('aria-hidden', 'true');
        blocked.hidden = true;
      });

      // Intercept button clicks: try preview; if blocked, auto-navigate
      buttons.forEach(btn => {
        btn.addEventListener('click', (e) => {
          const url = btn.dataset.docUrl || btn.getAttribute('href');
          const title = btn.dataset.docTitle || btn.textContent.trim();
          if (!url) return;

          e.preventDefault(); // attempt preview first
          loadDoc(title, url, { autoNavigateOnBlock: true });
        });
      });

      // Deep-link via ?doc=
      const params = new URLSearchParams(location.search);
      const docParam = params.get('doc');
      if (docParam) {
        const match = Array.from(buttons).find(b =>
          (b.dataset.docTitle || b.textContent || '').toLowerCase().includes(docParam.toLowerCase())
        );
        if (match) {
          loadDoc(match.dataset.docTitle || match.textContent.trim(),
                  match.dataset.docUrl || match.href,
                  { autoNavigateOnBlock: false });
        }
      }
    })();
  </script>

</body>
</html>
